<!DOCTYPE html>
<html>
  <head>
    <title>{{ title }}</title>
    
   
    
   <link rel='stylesheet' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css'/>
   <link rel='stylesheet' href='/stylesheets/style.css' />
    <!-- <link rel='stylesheet' href='/stylesheets/flat-ui.css'/> -->
  </head>
  <body>
    <!-- Her kommer navbaren -->
    <nav class="navbar navbar-default navbar-fixed-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">{{name}}</a>
    </div>

    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
        {{#links}}
        <li><a href={{url}}>{{name}}</a></li>
        {{/links}}
      </ul>
       
      <ul class="nav navbar-nav navbar-right">
      
           <li><button id="logout" class="btn btn-success navbar-btn">Logg ut</button></li> 
              
          </ul>
        
      </ul>
    </div>
  </div>
</nav>

<br>
    <div class="col-md-3">
      <div class="panel panel-default">
        <div class="container-fluid">
          <div class="panel-header"><button data-toggle="collapse" data-target="#panelinfo" id="infobutton" style="
            right: 16px;
            border-style:none;
            margin: 0;
            position: absolute;
            "class="btn btn-default glyphicon glyphicon-option-horizontal"></button><h4>Informasjon</h4></div>
            <div class="panel-body panel-collapse collapse in"  id="panelinfo">
              <p>Velkommen til <label class="label label-success">{{ title }}</label></p>
              <p>Versjon: <label class="label label-primary">{{version}}</label></p>
              <p>Bedrift: <label class="label label-info">{{bedrift}}</label></p>
            </div>
        </div>
      </div>
    </div>

    <div class="col-md-5">
     <div  class="panel panel-default">
        <div class="container-fluid">
            <div class="panel-header"><button data-toggle="collapse" data-target="#panelstatistikk" style="
            right: 16px;
            border-style:none;
            margin: 0;
            position: absolute;
            "class="btn btn-default glyphicon glyphicon-option-horizontal"></button><h4>Aktivitet</h4></div>
            <div class="scaling panel-body panel-collapse collapse in " id="panelstatistikk">

              <div class="col-md-3">
                <a href="" class="thumbnail">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Microsoft_Excel_2013_logo.svg/110px-Microsoft_Excel_2013_logo.svg.png" />
                </a>

              </div>

              <div class="col-md-2"><label class="label label-info">Excel er koplet til databasen og kjører</label><br><label class="label label-success">Online</label></div>

              <br><br><br> 

             
                <h4>Siste aktivitet</h4>
               
                <table id="tbl" class="table table-striped">
                   <tr>
                        <td>
                          Bruker
                        </td> 
                        <td>
                          Sist inlogget
                        </td>
                        <td>
                          Sist utlogget
                        </td>
                        <td>
                          Sist aktiv
                        </td>
                        <td>
                          Arbeidstimer totalt(idag)
                        </td>
                    </tr>

                    
                </table>
              
            </div>
         </div>
      </div>
    </div>

    <div class="col-md-4">
     <div class="panel panel-default ">
        <div class="container-fluid">
            <div class="panel-header"><button style="
            right: 16px;
            border-style:none;
            margin: 0;
            position: absolute;
            "class="btn btn-default glyphicon glyphicon-option-horizontal" data-toggle="collapse" data-target="#panelbrukere"></button><h4>Brukere</h4></div>
            <div id="panelbrukere" class="panel-body panel-collapse collapse in ">
        
            <ul class="list-group">
               {{#brukere}}

               <div id="dropdown{{id}}" class="dropdown">
                <li id="listitem{{id}}" class="list-group-item clearfix">{{name}}  &nbsp; <span class="pull-right">

          <ul id="dropdownlist{{id}}" class="dropdown-menu">
                  <li><a href="" data-toggle="modal" data-target="#modaluser{{id}}">Rediger bruker</a></li>
                  <li><a href="">Status</a></li>
                  <li role="seperator" class="divider"></li>
                  <li><a href="">Slett bruker</a></li>
                </ul>
                  <button id="person{{id}}" style="font-size: x-small ; height:25px;" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Endre <span class="caret"></span></button>

                    
                </span>

                
              </li>
                
                
                {{/brukere}}

                
              </div>
            </ul>

          </div>
        
        </div>
      </div>
    </div>
     

    <!-- modals:: -->
    {{#brukere}}
    <div class="modal fade" id="modaluser{{id}}" tabindex="-1" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">{{title}} | {{bedrift}}</h4>
          </div>
          <div class="modal-body">
            <p>Bruker: {{name}}&hellip;</p>
            <input type="text" class="form-control" placeholder="Navn.." id="brukerNavn"/>

          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Lukk</button>
            <button type="button" class="btn btn-primary">Lagre endringer</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div><!-- /.modal -->
    {{/brukere}}
  </body>
  <!-- JQuery og Bootstrap -->
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.4.min.js"></script>
  <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

  <script type="text/javascript">
        
        var socket = io('http://localhost:8080');
          socket.on('new message', function (data) {
              alert('Hello: ' + data.name + ', \n' + data.text);

          });

          socket.on('recieveJSON', function(data){
              var s = '<tr>' + 
              '<td>' + data.name +  '</td>' + '<td>' + data.desc +  '</td>' + 
              '<td>' + data.registered +  '</td>' + '<td>' + data.left +  '</td>'  + '</tr>';
              
              $('#tbl').append(s);
               
          });
        socket.connect();
        
         
        
        {{#brukere}}
          $('#person{{id}}').click(function () {
            console.log('hello{{id}}');
            $('#dropdownlist{{id}}').closest(".dropdown-menu").prev().dropdown("toggle");
          });

           
        {{/brukere}}


        $('#logout').click(function(){
          socket.emit('hello', {name: 'Marius Sørenes', age: '20'});
          
          $.ajax({
            url: '/index/userdisconnect',
            type: 'POST',
            success: function(data){

            }

        });
        });
        
          

  </script>
  </html>